<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta name="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains; preload">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cook.beaverlyai.com https://coox.beaverlyai.com https://wofk.beaverlyai.com https://work.beaverlyai.com https://www.googletagmanager.com https://cdn.botpress.cloud https://files.bpcontent.cloud https://cdn.jsdelivr.net 'sha256-SCfHb0f59QEhuYaon2DqnZfALcsBcsqwAhgV/RxmHnI='; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com; img-src 'self' data: https://cook.beaverlyai.com https://coox.beaverlyai.com https://wofk.beaverlyai.com https://work.beaverlyai.com https://www.google.com https://www.google.com.ng https://stats.g.doubleclick.net; connect-src 'self' https://cook.beaverlyai.com https://coox.beaverlyai.com https://wofk.beaverlyai.com https://work.beaverlyai.com wss://cook.beaverlyai.com wss://coox.beaverlyai.com wss://wofk.beaverlyai.com wss://work.beaverlyai.com https://www.google-analytics.com https://analytics.google.com https://stats.g.doubleclick.net https://region1.google-analytics.com https://region1.analytics.google.com https://webchat.botpress.cloud wss://webchat.botpress.cloud https://cdn.jsdelivr.net; frame-src 'none'; object-src 'none'; base-uri 'self'; form-action 'self' https://cook.beaverlyai.com https://coox.beaverlyai.com https://wofk.beaverlyai.com https://work.beaverlyai.com;">
    <title>Get Started - Chilla by Beaverly</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/mandate-wizard.css">
    <link rel="stylesheet" href="css/strategy-catalog.css">
    <link rel="stylesheet" href="css/wizard-fixed-footer.css">
    <!-- Chart.js for backtest visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div id="app">
        <!-- Loading Screen -->
        <div id="loading-screen" class="loading-screen">
            <div class="loading-content">
                <div class="logo">Chilla</div>
                <div class="loading-spinner"></div>
            </div>
        </div>
        <!-- Global fixed footer for wizard actions -->
        <div class="wizard-footer-fixed" id="wizard-footer">
            <div class="footer-left">
                <button id="wizard-cancel" class="btn-secondary">Cancel</button>
            </div>
            <div class="footer-actions">
                <button id="wizard-back" class="btn-secondary">Back</button>
                <button id="wizard-action" class="btn-primary" disabled>Continue</button>
            </div>
        </div>

        <!-- Wizard Container -->
        <div id="wizard-container" class="wizard-container hidden">
            <!-- Progress Bar -->
            <div class="wizard-progress">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <div class="progress-steps">
                    <div class="progress-step active" data-step="1">
                        <div class="step-number">1</div>
                        <div class="step-label">Strategy</div>
                    </div>
                    <div class="progress-step" data-step="2">
                        <div class="step-number">2</div>
                        <div class="step-label">Markets</div>
                    </div>
                    <div class="progress-step" data-step="3">
                        <div class="step-number">3</div>
                        <div class="step-label">Risk</div>
                    </div>
                    <div class="progress-step" data-step="4">
                        <div class="step-number">4</div>
                        <div class="step-label">Consent</div>
                    </div>
                    <div class="progress-step" data-step="5">
                        <div class="step-number">5</div>
                        <div class="step-label">Activate</div>
                    </div>
                </div>
            </div>

            <!-- Step 1: Strategy Selection -->
            <div id="step-1" class="wizard-step active">
                <div class="step-header">
                    <h1>Choose your strategy</h1>
                    <p>Pick one that fits your style. Chilla will execute accordingly.</p>
                </div>
                <!-- Netflix-style Strategy Catalog -->
                <div id="strategy-catalog"></div>
                
                <!-- Fixed footer for Step 1 removed (global footer used) -->
            </div>

            <!-- Step 2: Market Selection (NEW) -->
            <div id="step-2" class="wizard-step">
                <div class="step-header">
                    <h1>Pick your markets</h1>
                    <p>Select which markets Chilla should execute your instructions in. Start with one, or mix a few.</p>
                </div>
                <div id="markets-container" class="markets-container">
                    <!-- Markets loaded dynamically -->
                </div>
                <div class="markets-footer">
                    <span id="selected-markets-count" class="markets-count">0 selected</span>
                </div>
                
                <!-- Fixed footer for Step 2 removed (global footer used) -->
            </div>

            <!-- Step 3: Risk Setup (previously Step 2) -->
            <div id="step-3" class="wizard-step">
                <div class="step-header">
                    <h1>Set your risk</h1>
                </div>
                <div class="risk-setup">
                    <!-- Per-Strategy Risk (Primary Section) -->
                    <div class="risk-main-card">
                        <h3>Per-signal risk</h3>
                        <p class="section-description">How much you're willing to risk on each signal.</p>
                        
                        <div class="risk-input-group">
                            <label for="risk-slider">Risk per signal</label>
                            <input id="risk-slider" type="range" min="0.01" max="5.00" value="1.00" step="0.01" class="risk-slider">
                            <div class="slider-value"><span id="risk-display-value">1.00%</span></div>
                        </div>

                        <div class="risk-actions" style="display:flex;gap:0.75rem;margin-top:1rem;">
                            <button id="reset-risk-btn" class="btn-secondary">Reset</button>
                            <button id="save-risk-btn" class="btn-primary">Save</button>
                        </div>

                    </div>

                    <!-- Optional Settings (accordion-style modern option cards) -->
                    <div class="option-card-container">
                        <details class="option-card" id="omega-card">
                            <summary>
                                <div class="option-header">
                                    <div>
                                        <h4>Omega Risk Cap</h4>
                                        <div class="option-description">Set a monthly risk budget and pause behavior.</div>
                                    </div>
                                    <label class="toggle-switch">
                                        <input class="toggle-input" type="checkbox" id="omega-enabled" checked>
                                        <span class="toggle-label"><span class="toggle-slider"></span></span>
                                    </label>
                                </div>
                            </summary>
                            <div class="option-body">
                                <div class="slider-container">
                                    <input type="range" id="omega-slider" class="risk-slider" min="1" max="10" value="5" step="0.5">
                                    <div class="slider-value">
                                        <span id="omega-display-value">5.0%</span>
                                    </div>
                                </div>
                                <div class="omega-mode">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="omega-strict-mode">
                                        <span>Strict mode (pause at cap)</span>
                                    </label>
                                </div>
                            </div>
                        </details>

                        <details class="option-card" id="adaptive-card">
                            <summary>
                                <div class="option-header">
                                    <div>
                                        <h4>Adaptive Risk</h4>
                                        <div class="option-description">Auto-adjust your position sizing using volatility rules.</div>
                                    </div>
                                    <label class="toggle-switch">
                                        <input class="toggle-input" type="checkbox" id="adaptive-risk-toggle">
                                        <span class="toggle-label"><span class="toggle-slider"></span></span>
                                    </label>
                                </div>
                            </summary>
                            <div class="option-body">
                                <p style="color:var(--muted-color);font-size:0.95rem;margin:0">Adaptive risk tracks real-time market volatility and adjusts risk automatically — no action needed when active.</p>
                            </div>
                        </details>
                    </div>

                        <!-- Risk Preview (shown after calculation) -->
                        <div id="risk-preview" class="risk-preview hidden">
                            <div class="preview-icon">
                                <i data-lucide="bar-chart-2"></i>
                            </div>
                            <div class="preview-content">
                                <div class="preview-item">
                                    <span class="preview-label">Expected monthly signals:</span>
                                    <span class="preview-value" id="preview-signals">—</span>
                                </div>
                                <div class="preview-item">
                                    <span class="preview-label">Estimated monthly risk:</span>
                                    <span class="preview-value" id="preview-monthly-risk">—</span>
                                </div>
                                <div class="preview-item">
                                    <span class="preview-label">Risk level:</span>
                                    <span class="preview-value" id="preview-risk-level">—</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Optional: See Omega & Adaptive as inline cards above -->

                    <!-- Risk Implications (calculated on backend) -->
                    <div id="risk-indicator" class="risk-indicator">
                        <!-- Populated after backend calculation -->
                    </div>
                </div>

                
                <!-- Fixed footer for Step 3 removed (global footer used) -->
            </div>

            <!-- Step 4: Consent (previously Step 3) -->
            <div id="step-4" class="wizard-step">
                <div class="step-header">
                    <h1>Quick legal summary</h1>
                    <p>Read and accept the disclosures to proceed.</p>
                </div>
                <div class="consent-container">
                    <div id="consent-text" class="consent-text">
                        <div class="loading-shimmer"></div>
                        <p>In plain terms, this explains what Chilla will do with your instructions, the limits you set, and how to change or revoke those instructions.</p>
                    </div>
                </div>
                
                <div class="consent-checkbox-wrapper">
                    <label class="consent-label">
                        <input type="checkbox" id="consent-accept" class="consent-input">
                        <span>I have read, understand, and authorize Chilla to execute strictly within my rules</span>
                    </label>
                </div>
                
                <!-- Fixed footer for Step 4 removed (global footer used) -->
            </div>

            <!-- Step 5: Activation (previously Step 4) -->
            <div id="step-5" class="wizard-step">
                <div class="step-header">
                    <h1>You're all set!</h1>
                    <p>Review your selections and activate Chilla. You can change these anytime.</p>
                </div>
                <div class="activation-content">
                    <div class="activation-summary">
                        <div class="summary-card">
                            <div class="summary-icon">
                                <i data-lucide="zap"></i>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Strategy</div>
                                <div class="summary-value" id="final-strategy">—</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-icon">
                                <i data-lucide="trending-up"></i>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Markets</div>
                                <div class="summary-value" id="final-markets">—</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-icon">
                                <i data-lucide="target"></i>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Per-signal risk</div>
                                <div class="summary-value" id="final-per-signal-risk">—</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-icon">
                                <i data-lucide="shield"></i>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Monthly cap</div>
                                <div class="summary-value" id="final-monthly-cap">—</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-icon">
                                <i data-lucide="check-circle"></i>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Disclosures</div>
                                <div class="summary-value">Accepted</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Fixed footer for Step 5 removed (global footer used) -->
            </div>

            <!-- Success Screen -->
            <div id="success-screen" class="wizard-step">
                <div class="success-content">
                    <div class="success-icon" aria-hidden="true"></div>
                    <h1>Chilla is live!</h1>
                    <p>All set — you're good to chill.</p>
                    <div class="success-actions">
                        <button id="go-to-dashboard" class="btn-primary">Go to Dashboard</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Error Modal -->
        <div id="error-modal" class="error-modal hidden">
            <div class="error-modal-content">
                <div class="error-icon">⚠️</div>
                <h3>Oops!</h3>
                <p id="error-message">Something went wrong. Please try again.</p>
                <button id="error-close" class="btn-primary">Got it</button>
            </div>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/api-client.js"></script>
    <script src="js/strategy-catalog.js"></script>
    <script src="js/mandate-wizard.js"></script>
</body>
</html>
